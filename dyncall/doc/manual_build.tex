%//////////////////////////////////////////////////////////////////////////////
%
% Copyright (c) 2007,2009 Daniel Adler <dadler@uni-goettingen.de>, 
%                         Tassilo Philipp <tphilipp@potion-studios.com>
%
% Permission to use, copy, modify, and distribute this software for any
% purpose with or without fee is hereby granted, provided that the above
% copyright notice and this permission notice appear in all copies.
%
% THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
% WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
% MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
% ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
% WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
% ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
% OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
%
%//////////////////////////////////////////////////////////////////////////////

\newpage
\section{Building the library}

The library has been built and used successfully on several 
platform/architecture configurations and build systems.
Please see notes on specfic platforms to check if the target
architecture is currently supported.


\subsection{Requirements}

The following tools are supported directly to build the \product{dyncall} library.
However, as the number of source files to be compiled for a given
platform is small, it shouldn't be difficult to build it manually with
another toolchain.
\begin{itemize}
\item C compiler to build the \product{dyncall} library (GCC or Microsoft C/C++ compiler)
\item C++ compiler to build the optional test cases (GCC or Microsoft C/C++ compiler)
\item Python (optional - for generation of some test cases)
\item BSD make, GNU make, or Microsoft nmake as automated build tools
\end{itemize}


\subsection{Supported/tested platforms and build systems}

Although it is possible to build the \product{dyncall} library on more platforms
than the ones outlined here, this section doesn't list operating systems or
architectures the authors didn't test. However, untested platforms using
the same build tools (e.g. the BSD family of operating systems using similar
flavors of the BSD make utility along with GCC, etc.) should work without
modification. If you have problems building the \product{dyncall} library on one of the
platforms mentioned below, or if you successfully built it on a yet unlisted
one, please let us know.\\
\\

\begin{tabular}{l l}
{\bf{\large x86}} &                                            \\
\hline\hline
{\bf Windows}      & nmake, GNU make (via MinGW)               \\
{\bf Darwin}       & GNU make, BSD make                        \\
{\bf Linux}        & GNU make                                  \\
{\bf Solaris}      & GNU make (Sun's make tool isn't supported)\\
{\bf FreeBSD}      & BSD make                                  \\
{\bf NetBSD}       & BSD make                                  \\
{\bf OpenBSD}      & BSD make                                  \\
{\bf DragonFlyBSD} & BSD make                                  \\
\hline
                   &                                           \\
                   &                                           \\


{\bf{\large x64}}  &                                           \\
\hline\hline
{\bf Windows}      & nmake                                     \\
{\bf Darwin}       & GNU make, BSD make                        \\
{\bf Linux}        & GNU make                                  \\
{\bf Solaris}      & GNU make (Sun's make tool isn't supported)\\
{\bf FreeBSD}      & BSD make                                  \\
{\bf NetBSD}       & BSD make                                  \\
{\bf OpenBSD}      & BSD make                                  \\
\hline
                   &                                           \\
                   &                                           \\


{\bf{\large PowerPC (32bit)}} &                                \\
\hline\hline
{\bf Darwin}       & GNU make, BSD make                        \\
{\bf Linux}        & GNU make                                  \\
{\bf NetBSD}       & BSD make                                  \\
\hline
                   &                                           \\
                   &                                           \\


{\bf{\large ARM9}} &                                           \\
\hline\hline
{\bf Nintendo DS} & nmake (and devkitPro\cite{devkitPro} tools)\\
\hline
                   &                                           \\
                   &                                           \\

{\bf{\large MIPS32}} &                                         \\
\hline\hline
{\bf Playstation Portable} & GNU make (and psptoolchain\cite{psptoolchain} tools) \\
\hline

\end{tabular}\\

\pagebreak

\subsection{Build instructions}


\begin{enumerate}
\item Configure the source

\paragraph{*nix flavour}
\begin{lstlisting}
./configure [--option ...]
\end{lstlisting}

\paragraph{windows flavour}

\begin{lstlisting}
.\configure [/option ...]
\end{lstlisting}

Available options:

\begin{tabular}{ll}	
{\tt prefix={\it path}} & specify installation prefix (Unix shell) \\
{\tt prefix} {\it path} & specify installation prefix (Windows batch) \\
{\tt target-x86}        & build for x86 architecture \\
{\tt target-x64}        & build for x64 architecture \\
{\tt target-ppc32}      & build for ppc 32-bit architecture (not on windows batch)\\
{\tt target-psp}        & cross-compile build for Playstation Portable (homebrew SDK)\\
{\tt target-nds-arm}    & cross-compile build for Nintendo DS (using ARM mode) \\
{\tt target-nds-thumb}  & cross-compile build for Nintendo DS (using THUMB mode) \\
{\tt tool-gcc}          & use GNU Compiler Collection tool-chain \\
{\tt tool-msvc}         & use Microsoft Visual C++ \\
{\tt asm-as}            & use the GNU Assembler \\
{\tt asm-nasm}          & use NASM Assembler \\
{\tt asm-ml}            & use Microsoft Macro Assembler \\
{\tt config-release}    & build release version (default) \\
{\tt config-debug}      & build debug version \\
\end{tabular}

\item Build the static libraries \product{dyncall}, \product{dynload} and \product{dyncallback}
\begin{lstlisting}
make                     # when using {GNU,BSD} Make
bsdmake                  # when using BSD Make on Darwin
make -f BSDmakefile      # when using BSD Make on NetBSD
nmake /f Nmakefile       # when using NMake on Windows
\end{lstlisting}
\item Install libraries and includes (not supported for nmake based builds)
\begin{lstlisting}
make install 
\end{lstlisting}
\item Optionally, build the test suites
\begin{lstlisting}
make test                # when using {GNU,BSD} Make
bsdmake test             # when using BSD Make on Darwin
make -f BSDmakefile test # when using BSD Make on NetBSD
nmake /f Nmakefile test  # when using NMake on Windows
\end{lstlisting}
\item Optionally, build the manual (Latex required)
\begin{lstlisting}
make doc                 # when using {GNU,BSD} Make
bsdmake doc              # when using BSD Make on Darwin
make -f BSDmakefile doc  # when using BSD Make on NetBSD
nmake /f Nmakefile doc   # when using NMake on Windows
\end{lstlisting}
\end{enumerate}
